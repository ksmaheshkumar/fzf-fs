#!/usr/bin/env bash
__fzf_fs_console_cd_up () 
{ 
    builtin unset -v console_prompt tmp;
    builtin typeset console_prompt="${console[0]##*/}" tmp;
    [[ -n "${console[1]}" || "${console[2]}" -eq 0 ]] || { 
        if [[ -n "$KSH_VERSION" ]]; then
            console[1]="$(command fzf --prompt=":${console_prompt} " --print-query <<< "")";
        else
            command tput sc;
            command tput cup 99999 0;
            if [[ -n "$ZSH_VERSION" ]]; then
                builtin vared -p ":${console_prompt} " tmp;
            else
                builtin read -re -p ":${console_prompt} " tmp;
            fi;
            console[1]="$tmp";
            command tput rc;
            command tput ed;
        fi
    };
    [[ -z "${console[1]//[0-9]/}" ]] && { 
        tmp="$(command printf '%*s' "${console[1]:-1}" "")";
        builtin cd "$(command printf '%s' "${tmp// /..\/}")";
        cwd[3]="$PWD";
        FzfFsCore__update_cwd
    };
    console[1]=
}
__fzf_fs_console_cd_up "$@";
builtin unset -f __fzf_fs_console_cd_up
